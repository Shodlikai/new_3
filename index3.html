<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infrequent Meanings</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        /* Asosiy ranglar va fon */
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s ease, color 0.3s ease;
            margin: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Kun rejimi */
        body.light-mode {
            background: linear-gradient(135deg, #f0f2f5 0%, #e6e9ed 100%);
            color: #333;
        }

        /* Tun rejimi */
        body.dark-mode {
            background: linear-gradient(135deg, #2c3e50 0%, #1e2a38 100%);
            color: #ecf0f1;
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex-grow: 1;
            padding: 20px;
            box-sizing: border-box;
        }

        .header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }

        .slider-wrapper {
            width: 100%;
            max-width: 500px;
            margin-bottom: 20px;
        }

        .slider {
            display: flex;
            align-items: center;
            gap: 10px;
            color: inherit;
        }

        .slider input[type="range"] {
            flex-grow: 1;
            -webkit-appearance: none;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            opacity: 0.7;
            transition: opacity .2s;
        }
        
        body.light-mode .slider input[type="range"] {
            background: #e0e0e0;
        }
        body.dark-mode .slider input[type="range"] {
            background: #5a738e;
        }

        .slider input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #40c4ff;
            cursor: pointer;
            box-shadow: 0 0 8px rgba(64, 196, 255, 0.7);
        }

        .slider input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #40c4ff;
            cursor: pointer;
            box-shadow: 0 0 8px rgba(64, 196, 255, 0.7);
        }

        .card {
            position: relative;
            width: 80%;
            max-width: 400px;
            height: 600px;
            background-color: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding: 10px;
            perspective: 1000px;
            overflow: hidden;
            /* ASL KODINGIZDAGI ANIMATSIYA */
            transition: transform 0.3s ease, left 0.3s ease, background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
            left: 0;
            color: inherit;
        }

        /* Tun rejimi uchun karta ranglari */
        body.dark-mode .card {
            --card-bg: #34495e;
            color: #ecf0f1;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        /* Kun rejimi uchun karta ranglari */
        body.light-mode .card {
            --card-bg: white;
            color: #333;
        }


        .card::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 20px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
            pointer-events: none;
        }

        .card-inner {
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-front,
        .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .card-front .image {
            display: none;
        }

        .card-back {
            transform: rotateY(180deg);
        }

        .top-circle,
        .bottom-circle {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            height: 100px;
            background-color: #40c4ff;
            border-radius: 0 0 100% 100%;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .top-circle {
            top: 0;
            transform: translate(-50%, -50%);
        }

        .bottom-circle {
            bottom: 0;
            transform: translate(-50%, 50%) rotate(180deg);
        }

        .content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .word-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .en-word {
            font-size: 32px;
            font-weight: bold;
            color: inherit;
            text-align: center;
        }

        .uz-word {
            font-size: 22px;
            font-weight: bold;
            color: red;
            text-align: center;
            padding: 0 10px;
        }

        .pronunciation {
            font-size: 16px;
            color: #888;
            margin-top: 5px;
        }

        .type {
            background-color: #40c4ff;
            color: white;
            font-size: 15px;
            padding: 1px 2px;
            border-radius: 5px;
        }

        .definition {
            text-align: center;
            color: #808080;
            font-size: 10px;
            line-height: 1.4;
            max-width: 90%;
        }

        .uzbek-hint,
        .uzbek-definition {
            font-size: 12px;
            color: #a0a0a0;
            margin-top: 5px;
            text-align: center;
            padding: 0 10px;
        }


        .card-buttons {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            width: 100%;
            padding: 20px;
        }

        #next-button,
        #audio-button {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            background-color: #40c4ff;
            color: white;
            cursor: pointer;
            font-size: 16px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
        }

        #next-button:hover,
        #audio-button:hover {
            background-color: #29b6f6;
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
        }

        .image {
            width: 150px;
            height: 150px;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        /* ASL KODINGIZDAGI ANIMATSIYA SINFLARI */
        .card.swiping-left {
            left: -100%;
            transform: rotate(-10deg);
        }

        .card.swiping-right {
            left: 100%;
            transform: rotate(10deg);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
            max-width: 80%;
            color: #333;
        }

        body.dark-mode .modal-content {
            background-color: #34495e;
            color: #ecf0f1;
        }


        #close-modal {
            margin-top: 10px;
            padding: 10px 20px;
            background-color: #40c4ff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        #close-modal:hover {
            background-color: #29b6f6;
        }

        /* Kun/Tun tugmasi */
        #theme-toggle {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        #theme-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }

        #theme-toggle::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            opacity: 0;
            transform: translate(-50%, -50%);
            transition: width 0.4s ease-out, height 0.4s ease-out, opacity 0.4s ease-out;
        }

        #theme-toggle:active::before {
            width: 120%;
            height: 120%;
            opacity: 1;
        }

        /* Taymer uslublari */
        .timer-container {
            margin-top: auto;
            margin-bottom: 5px;
            padding: 2px 5px;
            text-align: center;
            font-family: 'Inter', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: auto;
            max-width: 200px;
            box-sizing: border-box;
        }

        .timer-display {
            font-size: 2.5em;
            font-weight: bold;
            background: linear-gradient(to right, #ff7e5f, #feb47b, #86a8e7, #91eae4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: pulse 2s infinite alternate;
            text-shadow: 0 0 8px rgba(255, 126, 95, 0.4), 0 0 16px rgba(254, 180, 123, 0.4), 0 0 24px rgba(134, 168, 231, 0.4);
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 0.8;
            }
            100% {
                transform: scale(1.05);
                opacity: 1;
            }
        }
        
        /* Sahifa yuklanishi animatsiyasi */
        .card, .card-buttons, .timer-container {
            animation: fadeInSlideUp 0.8s ease-out forwards;
            opacity: 0;
        }
        .card { animation-delay: 0.2s; }
        .card-buttons { animation-delay: 0.4s; }
        .timer-container { animation-delay: 0.6s; }

        @keyframes fadeInSlideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body class="light-mode">
    <div class="container">
        <div class="header">
            <div class="slider-wrapper">
                <div class="slider">
                    <span id="slider-value">1 / 30</span>
                    <input type="range" id="word-slider" min="0" value="0">
                    <span id="slider-max">30</span>
                </div>
            </div>
            <button id="theme-toggle" class="rounded-full w-10 h-10 flex items-center justify-center shadow-md">
                ‚òÄÔ∏è
            </button>
        </div>


        <div class="card">
            <div class="card-inner">
                <div class="card-front">
                    <div class="top-circle"></div>
                    <div class="content">
                        <div class="word-container">
                            <div class="word en-word"></div> <span class="pronunciation" id="pronunciation"></span>
                            <div class="uzbek-hint" id="uzbek-hint"></div>
                        </div>
                        <div class="type" id="type-front"></div>
                    </div>
                    <div class="bottom-circle"></div>
                    <div class="definition">Ta'rifni ko'rish uchun bosing</div>
                </div>
                <div class="card-back">
                    <div class="top-circle"></div>
                    <img src="https://placehold.co/150x150/40c4ff/ffffff?text=Image" alt="Rasm" class="image"
                        id="back-image">
                    <div class="content">
                        <div class="word uz-word"></div>
                        <div class="type" id="type-back"></div>
                        <div class="uzbek-definition" id="uzbek-definition"></div>
                    </div>
                    <div class="bottom-circle"></div>
                    <div class="definition">Ta'rif tarjimasi</div>
                </div>
            </div>
        </div>

        <div class="card-buttons">
            <button id="audio-button">Ovoz</button>
            <button id="next-button">Keyingi</button>
        </div>

        <div class="timer-container">
            <div class="timer-display" id="timer-display">00:00</div>
        </div>
    </div>

    <div id="instruction-modal" class="modal">
        <div class="modal-content">
            <h2>Fleshcarddan foydalanish bo'yicha yo'riqnoma</h2>
            <p>&#x25B6; O'ngga sursangiz **keyingi** so'zga o'tasiz (o'sish tartibi).</p>
            <p>&#x25C0; Chapga sursangiz so'z **yodlangan** hisoblanadi va ro'yxatdan o'chiriladi.</p>
            <p>&#x1F504; Kartani ustiga bosing va so'zning inglizcha ma'nosini ko'rasiz.</p>
            <p>&#x1F50A; "Ovoz" tugmasini bosib, kartaning hozirgi tomonidagi matnni eshitasiz (old tomonda inglizcha so'zni, orqa tomonda inglizcha ta'rifni).</p>
            <button id="close-modal">Tushunarli</button>
        </div>
    </div>

    <script src="https://code.responsivevoice.org/responsivevoice.js?key=ftro4Sxr"></script>
    <script>
        const card = document.querySelector('.card');
        const type = document.querySelector('.type');
        const slider = document.querySelector('.slider input[type="range"]');
        const sliderValue = document.getElementById('slider-value');
        const sliderMax = document.getElementById('slider-max');
        const nextButton = document.getElementById('next-button');
        const audioButton = document.getElementById('audio-button');
        const backImage = document.getElementById('back-image');
        const pronunciationElement = document.querySelector('.pronunciation');
        const uzbekHintElement = document.getElementById('uzbek-hint');
        const uzbekDefinitionElement = document.getElementById('uzbek-definition');
        const instructionModal = document.getElementById('instruction-modal');
        const closeModalButton = document.getElementById('close-modal');
        const themeToggle = document.getElementById('theme-toggle');
        const body = document.body;

        const PIXABAY_API_KEY = "49146347-e05e26bd1aae0010e8163774c";

        const learnedWords = [];
let words = [
  {
    "english": "Once",
    "definition": "at some time in the past, but not now",
    "uzbekDefinition": "o'tmishda qaysidir vaqtda, lekin hozir emas",
    "uzbek": "qachondir",
    "type": "ravish"
  },
  {
    "english": "Ordinary",
    "definition": "average, common, or usual, not different or special",
    "uzbekDefinition": "o'rtacha, umumiy yoki odatiy, farqli yoki maxsus bo'lmagan",
    "uzbek": "oddiy",
    "type": "sifat"
  },
  {
    "english": "Ancestor",
    "definition": "a member of your family who lived a long time ago",
    "uzbekDefinition": "sizning oilangizdan uzoq o'tmishda yashagan a'zo",
    "uzbek": "ajdod",
    "type": "ot"
  },
  {
    "english": "Private",
    "definition": "not related to, owned by, or paid for by the government",
    "uzbekDefinition": "hukumatga aloqador bo'lmagan, hukumatga tegishli bo'lmagan yoki u tomonidan to'lanmaydigan",
    "uzbek": "xususiy",
    "type": "sifat"
  },
  {
    "english": "Remain",
    "definition": "to continue to be in the same state or condition",
    "uzbekDefinition": "bir xil holatda yoki sharoitda bo'lishni davom ettirmoq",
    "uzbek": "qolmoq",
    "type": "fe'l"
  },
  {
    "english": "Celebrity",
    "definition": "a famous living person",
    "uzbekDefinition": "mashhur, hayot bo'lgan shaxs",
    "uzbek": "mashhur shaxs",
    "type": "ot"
  },
  {
    "english": "Treat",
    "definition": "to try to cure an illness or injury by using drugs, hospital care, operations etc",
    "uzbekDefinition": "dori-darmonlar, shifoxona parvarishi, operatsiyalar va h.k. yordamida kasallik yoki jarohatni davolashga harakat qilmoq",
    "uzbek": "davolamoq",
    "type": "fe'l"
  },
  {
    "english": "Hope",
    "definition": "to want something to happen or be true and to believe that it is possible or likely",
    "uzbekDefinition": "biror narsaning sodir bo'lishini yoki haqiqat bo'lishini xohlash va buning mumkinligiga ishonish",
    "uzbek": "umid qilmoq",
    "type": "fe'l"
  }
]


        function shuffleWords() {
            words = words.sort(() => Math.random() - 0.5);
        }
        shuffleWords();

        let currentIndex = 0;

        slider.min = 0;
        slider.max = words.length - 1;
        slider.value = 0;
        sliderMax.textContent = words.length;

        async function getPixabayImage(query) {
            const url = `https://pixabay.com/api/?key=${PIXABAY_API_KEY}&q=${query}&image_type=photo`;
            try {
                const response = await fetch(url);
                const data = await response.json();
                return (data.hits.length > 0) ? data.hits[0].webformatURL : "https://placehold.co/150x150/40c4ff/ffffff?text=Image";
            } catch (error) {
                console.error("Pixabay API error:", error);
                return "https://placehold.co/150x150/40c4ff/ffffff?text=Image";
            }
        }

        async function updateCard(index) {
            if (words.length === 0) {
                document.querySelector('.card-front .en-word').textContent = "Barcha so'zlar yodlandi!";
                pronunciationElement.textContent = "";
                type.textContent = "";
                uzbekHintElement.textContent = "";
                backImage.src = "https://placehold.co/150x150/40c4ff/ffffff?text=Image";
                document.querySelector('.card-back .uz-word').textContent = "";
                uzbekDefinitionElement.textContent = "";
                document.querySelector('.card-back .type').textContent = "";
                slider.value = 0;
                sliderMax.textContent = 0;
                sliderValue.textContent = "0 / 0";
                return;
            }

            if (index < 0) {
                index = words.length - 1; 
            } else if (index >= words.length) {
                index = 0; 
            }

            document.querySelector('.card-front .en-word').textContent = words[index].english;
            pronunciationElement.textContent = words[index].pronunciation;
            type.textContent = words[index].type;
            uzbekHintElement.textContent = words[index].uzbek;

            document.querySelector('.card-back .uz-word').textContent = words[index].definition;
            uzbekDefinitionElement.textContent = words[index].uzbekDefinition;
            document.querySelector('.card-back .type').textContent = words[index].type;

            slider.value = index;
            sliderValue.textContent = `${index + 1} / ${words.length}`;
            currentIndex = index;

            const imageUrl = await getPixabayImage(words[index].english);
            backImage.src = imageUrl;

            checkAndDownloadAudio(words[index].english);
            card.classList.remove('flipped');
        }

        async function checkAndDownloadAudio(audioFile) {
            console.log("Audio check/download for:", audioFile);
        }

        card.addEventListener('click', function () {
            this.classList.toggle('flipped');
        });

        slider.addEventListener('input', function () {
            updateCard(parseInt(this.value));
        });

        // "KEYINGI" TUGMASI ENDI ANIMATSIYA BILAN
        nextButton.addEventListener('click', function () {
            card.classList.add('swiping-right');
            
            setTimeout(() => {
                currentIndex++;
                if (currentIndex >= words.length) {
                    currentIndex = 0;
                }
                updateCard(currentIndex);

                card.classList.remove('swiping-right');
                card.style.left = '';
                card.style.transform = '';
            }, 300);
        });

        function speak(text) {
            responsiveVoice.speak(text, "US English Male", { rate: 0.9 });
        }

        audioButton.addEventListener('click', function () {
            if (card.classList.contains('flipped')) {
                speak(words[currentIndex].definition);
            } else {
                speak(words[currentIndex].english);
            }
        });

        let startX = 0;
        let endX = 0;

        card.addEventListener('touchstart', (e) => {
            startX = e.touches[0].clientX;
        });

        card.addEventListener('touchend', (e) => {
            endX = e.changedTouches[0].clientX;
            handleSwipe();
        });

        // TO'G'IRLANGAN SVAYP (SWIPE) MANTIQI (SILLIQ ANIMATSIYA)
        function handleSwipe() {
            const deltaX = endX - startX;

            if (deltaX > 50) { // O'ngga surish (Keyingi so'zga o'tish)
                card.classList.add('swiping-right'); 
                setTimeout(() => { 
                    currentIndex++; 
                    if (currentIndex >= words.length) {
                        currentIndex = 0; 
                    }
                    updateCard(currentIndex); 
                    
                    card.classList.remove('swiping-right');
                    card.style.left = '';
                    card.style.transform = '';
                }, 300);

            } else if (deltaX < -50) { // Chapga surish (Yodlangan deb belgilash)
                
                card.classList.add('swiping-left'); 
                
                setTimeout(() => { 
                    const learnedWord = words.splice(currentIndex, 1)[0];
                    learnedWords.push(learnedWord);
                    console.log("Yodlangan so'zlar:", learnedWords);

                    if (words.length === 0) {
                        showCustomAlert("Barcha so'zlar yodlandi! Yangi so'zlar qo'shishingiz mumkin.");
                        updateCard(-1); 
                        card.classList.remove('swiping-left');
                        card.style.left = '';
                        card.style.transform = '';
                        return;
                    }

                    if (currentIndex >= words.length) {
                        currentIndex = 0;
                    }

                    slider.max = words.length - 1; 
                    sliderMax.textContent = words.length; 

                    updateCard(currentIndex); 

                    card.classList.remove('swiping-left');
                    card.style.left = '';
                    card.style.transform = '';
                }, 300);
            }
        }

        document.addEventListener("DOMContentLoaded", function () {
            closeModalButton.addEventListener("click", function () {
                instructionModal.style.display = "none";
            });
            instructionModal.style.display = "flex"; 
            updateCard(0); 
            startTimer(); 
        });

        // Kun/Tun rejimi funksiyasi
        themeToggle.addEventListener('click', () => {
            body.classList.toggle('dark-mode');
            body.classList.toggle('light-mode');
            if (body.classList.contains('dark-mode')) {
                themeToggle.textContent = 'üåô';
                themeToggle.style.background = 'linear-gradient(135deg, #4b6cb7, #182848)'; 
            } else {
                themeToggle.textContent = '‚òÄÔ∏è';
                themeToggle.style.background = 'linear-gradient(135deg, #FFD700, #FFA500)'; 
            }
        });

        // Taymer funksiyasi
        const timerDisplay = document.getElementById('timer-display');
        let timerInterval;
        let totalSeconds = 0;
        let isTimerRunning = false;

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return `${String(minutes).padStart(2, '0')}:${String(remainingSeconds).padStart(2, '0')}`;
        }

        function startTimer() {
            if (!isTimerRunning) {
                isTimerRunning = true;
                timerInterval = setInterval(() => {
                    totalSeconds++;
                    timerDisplay.textContent = formatTime(totalSeconds);
                }, 1000);
            }
        }

        // Custom Alert modal
        function showCustomAlert(message) {
            const existingAlert = document.getElementById('custom-alert-modal');
            if (existingAlert) {
                existingAlert.remove();
            }

            const alertModal = document.createElement('div');
            alertModal.id = 'custom-alert-modal';
            alertModal.className = 'modal';
            alertModal.innerHTML = `
                <div class="modal-content">
                    <p>${message}</p>
                    <button id="close-alert-modal" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded-md">OK</button>
                </div>
            `;
            document.body.appendChild(alertModal);
            alertModal.style.display = 'flex';

            document.getElementById('close-alert-modal').addEventListener('click', () => {
                alertModal.style.display = 'none';
                alertModal.remove();
            });
        }
    </script>
</body>

</html>
